import { ArticleSection } from "../../../../components/ArticleSection/ArticleSection";

# 不可变所有者扩展

`ImmutableOwner` 扩展是一种 `Token` 账户扩展，它可以防止 `Token` 账户的所有权发生任何更改。这可以保护账户免受未经授权的访问和转移尝试。

> 所有 `Token` 扩展程序的 ATA 默认启用了不可变所有者功能

<ArticleSection name="初始化代币账户" id="initializing-the-token-account" level="h2" />

要在 `Token` 账户上初始化 `ImmutableOwner` 扩展，我们需要使用 `initializeImmutableOwner()` 函数。

以下是如何使用不可变所有者扩展创建一个铸币：

```ts
import {
    Keypair,
    SystemProgram,
    Transaction,
    sendAndConfirmTransaction,
} from '@solana/web3.js';
import {
    createInitializeAccountInstruction,
    createInitializeImmutableOwnerInstruction,
    getAccountLen,
    ExtensionType,
    TOKEN_2022_PROGRAM_ID,
} from '@solana/spl-token';

const tokenAccount = Keypair.generate();

// Calculate the size needed for a Token account with Transfer Fee extension
const accountLen = getAccountLen([ExtensionType.ImmutableOwner]);

// Calculate minimum lamports required for rent exemption
const lamports = await connection.getMinimumBalanceForRentExemption(accountLen);

// Create the account with the correct size and owner
const createAccountInstruction = SystemProgram.createAccount({
    fromPubkey: keypair.publicKey,
    newAccountPubkey: tokenAccount.publicKey,
    space: accountLen,
    lamports,
    programId: TOKEN_2022_PROGRAM_ID,
});

// Initialize the Immutable Owner extension
const initializeImmutableOwnerInstruction = createInitializeImmutableOwnerInstruction(
    tokenAccount.publicKey,
    TOKEN_2022_PROGRAM_ID,
);

// Initialize the Token account itself
const initializeAccountInstruction = createInitializeAccountInstruction(
    tokenAccount.publicKey,
    mint.publicKey,
    keypair.publicKey,
    TOKEN_2022_PROGRAM_ID,
);

const transaction = new Transaction().add(
    createAccountInstruction,
    initializeImmutableOwnerInstruction,
    initializeAccountInstruction,
);

const signature = await sendAndConfirmTransaction(connection, transaction, [keypair, tokenAccount], {skipPreflight: false});

console.log(`Token accounts created! Check out your TX here: https://explorer.solana.com/tx/${signature}?cluster=devnet`);
```

如前所述，如果我们想将此扩展添加到 `Associated Token` 账户，只需使用 Token2022 程序对其进行初始化即可。
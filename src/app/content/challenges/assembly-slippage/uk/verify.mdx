import { ChallengeTitle } from "../../../../components/Challenges/ChallengeTitle";
import { RequirementList } from "../../../../components/Challenges/RequirementList";
import { Requirement } from "../../../../components/Challenges/Requirement";

<ChallengeTitle>Проковзування в sBPF асемблері</ChallengeTitle>

Тепер, коли ви вже маєте почуватися комфортно з написанням асемблера, ваша перевірка проковзування повинна працювати як для звичайних SPL-Token, так і для Token2022 рахунків.

> `amount` буде розміщено в пам'яті за тією ж константою, що і в прикладі. Головна відмінність полягає в тому, що ми не можемо отримати дані інструкції, використовуючи константу, оскільки `data_len` рахунку є динамічним (дані інструкції розташовані в кінці даних останнього рахунку).

Створіть програму, яка має лише одну інструкцію. Вона повинна:
- Приймати один SPL або Token2022 рахунок
- Приймати u64 (8-байтовий) мінімальний баланс у даних інструкції
- Динамічно обчислювати зміщення до мінімального балансу
- Якщо проковзування перевищено, записати рядок `Slippage exceeded` і повернути код помилки 1

> Щоб отримати правильне зміщення даних інструкції, ви можете використати наш [інструмент](https://sbpf.xyz). Але ми вам допоможемо: `data_len` токен-рахунку знаходиться за адресою `.equ TOKEN_ACCOUNT_DATA_LEN, 0x0058`

Почніть з встановлення пакету sBPF, як пояснено в [розділі про інструменти](/uk/courses/introduction-to-assembly/tooling) курсу "Вступ до асемблера", і зберіть вашу програму за допомогою наступної команди в терміналі:

```
sbpf build
```

Це згенерує файл `.so` у вашій папці `target/deploy`. 

Тепер натисніть на кнопку `take challenge` і перетягніть туди файл!

<RequirementList>
  <Requirement title="Завдання 1: Тестування проковзування з SPL-Token">
    Ваша програма повинна успішно виконуватися, коли кількість токенів на SPL-Token рахунку вища за кількість, передану в параметрах.
  </Requirement>

  <Requirement title="Завдання 2: Тестування невдачі проковзування">
    Ваша програма повинна завершитися невдачею, коли кількість токенів у Токен-акаунті менша за передану кількість.
  </Requirement>

  <Requirement title="Завдання 3: Тестування проковзування з Token2022">
    Ваша програма повинна успішно виконатися, коли кількість токенів у акаунті Token2022 більша за передану кількість.
  </Requirement>
</RequirementList>